Azure Foundation Lab Guide
Exercise 4: VNET peering
1.	Create two resource groups â€“ one for each network
ï‚§	RG-VNET1
ï‚§	RG-VNET2
 
 



2.	Create two VNets
VNet	Address Space	Subnet	Subnet Address	RG
VNET-1	10.0.0.0/16	Subnet-1	10.0.1.0/24	RG-VNET-1
VNET-2	10.1.0.0/16	Subnet-2	10.1.1.0/24	RG-VNET-2



VNET -1 creation
Create VNET with the name VNET-1 and choose resource group as RG-VNET-1
 

Under IP addresses add new subnet name it as Subnet-1 

 






Click on review create
 

VNET-2 creation

 

Under IP addresses change the Ip address space as 10.1.0.0/16 add new subnet name it as Subnet-2
 
Click on review create

 
3.	Deploy Virtual Machines â€“ Create one VM in each VNet.

VM Name	RG Name	VNet Name	Image
VM-1	RG-VNET-1	VNET-1	Ubuntu
VM-2	RG-VNET-2	VNET-2	Ubuntu

VM-1 Creation:
 
 


Under networking tab make sure to choose VNET-1 and click review create.

 

VM-2 Creation:

 

 

4.	Test connectivity before peering
ï‚§	Open VM-1 and click connect
 
â€¢	Copy the ssh command and run it in the command prompt. 
 
Connect to the VM and ping the VM-2 private ip address. 
 

5.	Creating VNET peering
â€¢	Go to VNET-1, choose peerings option and click on add. 
 
Name your peering link as VNET-1-TO-VENT-2 and choose VNET-2 as virtual network to connect with.
 
Click on add button to complete the peering.
 
6.	Test connectivity after peering
From VM-1 ping the private IP address of VM-2 -> ping -c4 <VM-2_private_ip>
  

Conclusion:
â€¢  VNet Peering allows private communication between Azure VNets.
â€¢  Traffic flows through Azureâ€™s backbone network (not internet).
â€¢  Peering can be intra-region or global.
â€¢  No overlapping IP spaces allowed.
â€¢  Billing: minimal â€” based on data transfer.

----------------------------------------------------------------------------------------------------


Fill the RG name, give name to ELB and change the type to public to access it publically.

We need to create front end IP config. Click on add frontend ip config.

After giving a name to the frontend ip config, Click on add public IP address. 

Provide public ip name and save it.

After creating new public ip. Click save button and click next.

Click on add backend pool.

Give a name to the backend pool and select the existing V-Net. Since we are going to add the VM scale set let save as of now. 

Click next and come to inbound rule. Click on add a load balancing rule.

Give a name to the outbound rule, choose frondend IP & backend IP as what we have created from the dropdown. Choose the frondend and backend port as 80. Now click on create new health probes.

Give name to health probe and change the protocol to HTTP and click save. Click next

Click on review create.

Checking the resource we created.

Enabling VMSS
Click on subscriptions. 

Choose the subscription name. 

Go to left side tab and select recourse provider under settings tab.

Type Stream in the search box and select Microsoft.StreamAnalytics. (Which is not registered). 

Select the resource provider and click register.

Re-registerÂ a resource provider to use locations that you added since the previous registration.

View resource provider
In theÂ All servicesÂ box, enterÂ resource explorer, and selectÂ Resource Explorer.

Select the right arrow to expandÂ Providers.

Expand the resource provider and resource type that you want to view. Resource Manager is supported in all regions, but the resources you deploy might not be supported in all regions. Also, there might be limitations on your subscription that prevent you from using some regions that support the resource. Resource Explorer displays valid locations for the resource type.
Click on Microsoft Batch -> batch Account -> Know the list of reason it is supported. 

The API version corresponds to a version of the resource provider's REST API operations. As a resource provider enables new features, it releases a new version of the REST API. Resource Explorer displays valid API versions for the resource type.


VM SCALE SET creation
From the home page search for virtual machine scale set. 

Click on create.

Choose the RG, Provide name to the VM scale set, select the zone, choose orchestration as flexible, select the image, click on password under administrator tab and provide the name and password. 



Under the networking tab, Select the V-Net that we used while creating ELB, select the subnet, choose load balancing option as azure load balancer, select the load balancer we created, select the backend pool we created. 


Under the management tab, disable boot diagnostic. Since this a lab we are disabling otherwise its recommended to enable this option.

In the advanced tab provide the user data for the VM and click on review create.
#!/bin/bash
# Install Apache Web Server
sudo apt update -y
sudo apt install -y apache2
sudo systemctl start apache2
sudo systemctl enable apache2

# Get the server hostname
HOSTNAME=$(hostname)

# Create a sample webpage with the server name
sudo bash -c "echo '<html><body><h1>Welcome to $HOSTNAME!</h1></body></html>' > /var/www/html/index.html"

NSG setting
Choose NSG from home page.

Select the NSG that is already present.

Click on setting on the left side pane and inbound security rule.

Click on add button and fill the details as given below. Change the source as My IP address and service as HTTP.

Go to the load balancer that we created and copy the frontend IP address and past it in the tab. 

The result will be.

Open another in the private window. We can witness the load getting distributed.


------------XXXXXXXXXXXXXX----------
VNet Peering

---------------------------------------------------------------------------------------------------------------------------

ğŸŒ Azure Resource Manager (ARM)
ğŸ’¡ Simple Explanation

Azure Resource Manager (ARM) is the management layer in Microsoft Azure that helps you create, update, and delete resources in your Azure account.
It acts as a central controller that receives all management requests (like creating a VM, storage account, or network) and ensures theyâ€™re deployed properly and securely.

âš™ï¸ How It Works

Users/Developers interact with Azure using:

Azure Portal

Azure CLI

PowerShell

REST APIs

These requests are sent to Azure Resource Manager (ARM).

ARM then communicates with the relevant Resource Providers (like Compute, Network, Storage, SQL, etc.) to carry out the request.

Resources are organized under Resource Groups, making it easier to manage and apply policies.

ğŸ”‘ Key Features

ğŸ§© Resource Groups: Logical containers for managing related resources.

ğŸ§¾ ARM Templates: JSON files used for automating deployments.

ğŸ” RBAC (Role-Based Access Control): Fine-grained access management.

ğŸ·ï¸ Tagging: Label and categorize resources for cost tracking or organization.

ğŸ” Consistency: Ensures all resources are deployed uniformly.

ğŸ“Š Visual Flow (for your diagram)
[ User / Developer ]
      â†“
(Azure Portal / CLI / PowerShell / SDK)
      â†“
  [ Azure Resource Manager (ARM) ]
  â”œâ”€â”€ Validates Request
  â”œâ”€â”€ Applies Policies & RBAC
  â”œâ”€â”€ Sends to Resource Providers
      â†“
[ Compute | Storage | Network | Database ]
      â†“
[ Resource Group ]

----------------------------------------------------------------------------

ğŸŸ¦ Slide Title: Azure Load Balancer and Virtual Machine Scale Sets (VMSS)
â˜ï¸ Concept Overview
âš–ï¸ Azure Load Balancer (ALB):

Azure Load Balancer automatically distributes incoming network traffic across multiple Virtual Machines (VMs) in a backend pool.

Ensures high availability and fault tolerance.

Continuously monitors VM health â€” if one VM fails, traffic is routed to healthy VMs.

Supports both inbound (Internet to VM) and outbound (VM to Internet) connections.

ğŸ” Azure Virtual Machine Scale Set (VMSS):

VMSS allows you to deploy and manage a group of identical VMs.

It automatically increases (scales out) or decreases (scales in) the number of VMs based on demand.

Ensures your application runs smoothly during traffic spikes and saves cost during low usage.

Works seamlessly with Load Balancer or Application Gateway.

ğŸ”— How They Work Together
Component	Function
Azure Load Balancer	Distributes traffic evenly among all VMs in the VMSS.
VM Scale Set	Automatically adjusts the number of VM instances based on metrics (CPU, memory, queue length, etc.).
Integration	When VMSS adds or removes instances, the Load Balancerâ€™s backend pool updates automatically to include/exclude them.
ğŸ–¼ï¸ Diagram Description (for image or slide)

Hereâ€™s the visual flow you can show:

                   ğŸŒ Users / Internet
                          â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ Azure Load Balancer â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚             â”‚             â”‚
   ğŸ–¥ï¸ VM Instance #1   ğŸ–¥ï¸ VM Instance #2   ğŸ–¥ï¸ VM Instance #3
        (Part of VM Scale Set)
                          â”‚
                 âš™ï¸ Azure Monitor / Autoscale Rules
                          â”‚
     â• Adds or â– Removes VMs Automatically Based on Demand


ğŸ’¡ Use Icons from Azure Architecture Icons Set:

Load Balancer â†’ Azure Load Balancer icon

VMs â†’ Virtual Machine icons

VMSS â†’ Virtual Machine Scale Set icon

Metrics â†’ Azure Monitor icon

ğŸ§© PPT Layout Suggestion

Slide layout idea:

Left side:

Title: Azure Load Balancer (ALB)

Bullets: purpose, function, benefits

Title: Azure Virtual Machine Scale Set (VMSS)

Bullets: scaling, cost optimization, automation

Right side:

Diagram showing users â†’ Load Balancer â†’ VMSS â†’ Auto-scaling

Bottom Caption:
â€œAzure Load Balancer evenly distributes traffic, while VM Scale Sets automatically scale the number of VMs based on workload demand.â€
-------------------------------------------------------------------------------------------------------
ğŸ§© Title: Deployment Technologies in Azure
1. What is Deployment in Azure?

Deployment in Azure means automating the process of creating, configuring, and managing resources (like VMs, storage, networks, databases, etc.) in a consistent and repeatable way.

It helps avoid manual errors and speeds up the delivery of cloud infrastructure or applications.

âš™ï¸ 2. Key Deployment Technologies in Azure
Technology	Description	Best For
Azure Portal	Web-based UI for creating and managing resources manually.	Small or demo deployments.
Azure CLI	Command-line tool (az commands) to deploy and manage resources via scripts.	Developers, automation scripts, CI/CD.
Azure PowerShell	Uses PowerShell cmdlets to manage Azure resources.	Admins familiar with Windows PowerShell.
ARM Templates (Azure Resource Manager Templates)	JSON-based templates that define infrastructure as code (IaC).	Repeatable, declarative deployments.
Bicep	Simplified language that compiles to ARM templates (IaC). Easier syntax than JSON.	Modern IaC with better readability.
Terraform (by HashiCorp)	Open-source IaC tool supporting multi-cloud deployments including Azure.	Cross-cloud environments & automation.
GitHub Actions / Azure DevOps Pipelines	CI/CD tools to automate build, test, and deployment workflows.	Continuous deployment for applications.
ğŸ§  3. Diagram â€“ Deployment Flow in Azure

You can include this visual in your slide:

[ Developer ]
     |
     v
[ Code Repository (GitHub/Azure Repos) ]
     |
     v
[ CI/CD Pipeline (Azure DevOps / GitHub Actions) ]
     |
     v
[ IaC Templates (Bicep / ARM / Terraform) ]
     |
     v
[ Azure Resource Manager (ARM) ]
     |
     v
[ Azure Resources Created ]


âœ… ARM is the control layer that ensures all resources are deployed in an organized and secure way.

ğŸš€ 4. Why Use Deployment Technologies?

Consistency: Deploy identical environments repeatedly.

Speed: Automate instead of manually configuring.

Scalability: Easily scale infrastructure.

Version Control: Track infrastructure changes in Git.

Integration: Works seamlessly with CI/CD pipelines.

ğŸ—ï¸ 5. Example: Simple Bicep Deployment
resource myStorage 'Microsoft.Storage/storageAccounts@2023-01-01' = {
  name: 'vidhyastorage001'
  location: resourceGroup().location
  sku: {
    name: 'Standard_LRS'
  }
  kind: 'StorageV2'
}


Then deploy using:

az deployment group create --resource-group myRG --template-file main.bicep

ğŸ¯ 6. Summary Slide

Manual: Azure Portal

Scripted: Azure CLI, PowerShell

Infrastructure as Code: ARM, Bicep, Terraform

Automated Pipelines: Azure DevOps, GitHub Actions

Together, they form the Azure Deployment Ecosystem, enabling DevOps-driven, automated, and repeatable deployments.

-----------------------------------------------------------------------
ğŸŒ What is Azure IAM?

Azure Identity and Access Management (IAM) â€” also known as Azure Role-Based Access Control (Azure RBAC) â€” is a framework that manages who can access what resources in Azure.

It ensures that only authorized users can perform specific actions on particular resources.

ğŸ§© Key Components of Azure IAM
Component	Description	Example
Identity	Represents a user, group, service principal, or managed identity.	User: vidya@company.com

Role Definition	A set of permissions (actions that can be performed).	Contributor, Reader, Owner
Scope	The level at which access applies â€” Management Group, Subscription, Resource Group, or Resource.	Apply a role to a specific Resource Group only.
Role Assignment	Connects an identity to a role at a specific scope.	Assign Reader role to User1 at RG1 scope.
ğŸ—ï¸ How Azure IAM Works

User/Service logs in â†’ authenticated via Azure AD (Azure Active Directory).

IAM checks role assignments â†’ what permissions the user has.

IAM enforces access control â†’ only allowed actions can be performed.

ğŸ” Built-in Roles

Azure provides several built-in roles (you can also create custom ones):

Role	Permissions
Owner	Full access, including assigning roles.
Contributor	Can create/manage resources, but not grant access.
Reader	Can only view resources.
User Access Administrator	Can manage access for other users.
ğŸ§± Scopes in Azure IAM (Hierarchy)
Management Group
     â†“
Subscription
     â†“
Resource Group
     â†“
Resource


ğŸ‘‰ Permissions are inherited down the hierarchy.

Example:
If a user is a Reader at the Subscription level â†’ they automatically have read access to all Resource Groups and Resources inside it.

ğŸ“˜ Example Scenario

Letâ€™s say:

You have a Subscription called Prod-Subscription

Inside it, a Resource Group App-RG

It contains a VM named App-Server

You can assign:

Vidya as Owner at App-RG (can manage everything in RG)

John as Reader at App-RG (can only view)

App Service Identity as Contributor on App-Server (can deploy code but not assign roles)

ğŸ¨ Diagram (for PPT)

Title: Azure IAM (Role-Based Access Control)

         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚     Azure AD (Identity)  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
           Authentication & Token
                      â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚        Azure IAM (RBAC)        â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
        Role Assignment: Who â†’ Role â†’ Scope
                      â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                  â”‚                   â”‚
User A â†’ Owner  @ Subscription   User B â†’ Reader @ RG1
Service Principal â†’ Contributor @ VM

ğŸ§  In Simple Terms

Azure IAM = Who (Identity) + What (Role) + Where (Scope)

Example:

Vidya (User) â†’ Contributor (Role) â†’ Resource Group â€œWebApp-RGâ€ (Scope)

This means Vidya can manage resources inside â€œWebApp-RGâ€ but cannot modify IAM settings.

ğŸ’¬ Tip for PPT

Use a slide layout like this:

Left side: Diagram

Right side: 3 bullets summarizing

âœ… Centralized access control
âœ… Role-based permissions
âœ… Inherited hierarchy
------------------------------------------------------------------------------------------------------------------------------

ğŸ’° Azure Cost Management and Billing
ğŸ”¹ Definition

Azure Cost Management and Billing is a suite of tools provided by Microsoft to help organizations monitor, allocate, and optimize cloud spending.
It ensures youâ€™re getting the maximum value out of your Azure resources.

ğŸ§© Key Components
Component	Description
Billing	Manages your invoices, payment methods, subscriptions, and overall account-level costs.
Cost Analysis	Provides visual reports and charts to analyze where your money is being spent across resources, services, and departments.
Budgets	Lets you set spending limits and receive alerts when you approach or exceed your defined thresholds.
Recommendations (Advisor)	Suggests ways to reduce costs, like resizing underutilized VMs or shutting down idle resources.
Exports	Automatically exports your cost data to Storage Accounts or Power BI for advanced analysis.
Cost Allocation Tags	Helps attribute costs to specific teams, projects, or environments using tags like Dept=Finance or Env=Production.
âš™ï¸ How Azure Cost Management Works
ğŸª„ Process Overview

Collects usage data from all your Azure resources (VMs, storage, databases, etc.).

Aggregates billing based on your subscription or management group.

Visualizes spending trends in dashboards and cost reports.

Analyzes cost patterns to find inefficiencies and savings opportunities.

Implements budgets & policies to control and predict future spend.

ğŸ“Š Common Tools in Azure Portal

Cost Management + Billing â†’ Access directly from the left menu in Azure Portal.

Cost Analysis â†’ View cost breakdowns by service, resource group, or tag.

Budgets â†’ Create alerts for exceeding set cost limits.

Advisor Recommendations â†’ Use the â€œCostâ€ tab for optimization tips.

ğŸš€ Best Practices

âœ… Tag all resources for accountability.
âœ… Set budgets for each department/project.
âœ… Use Reserved Instances or Savings Plans for predictable workloads.
âœ… Monitor cost anomalies daily or weekly.
âœ… Automate shutdown of idle environments (e.g., Dev/Test after hours).
âœ… Export cost data to Power BI for deep visualization and trend prediction.

ğŸŒ Azure DevOps + Terraform Integration (Org Context)

Since your org uses Azure DevOps (ADO) and Terraform (IaC):

You can integrate Cost Management data into your CI/CD pipelines to track infra cost changes per deployment.

Terraform tags (like project, env, owner) can automatically map to cost centers in Azure Cost Management.

ADO dashboards can pull Power BI reports with Azure cost insights for leadership visibility.

ğŸ–¼ï¸ Suggested Diagram for PPT
                +-----------------------------+
                |   Azure Cost Management     |
                +-----------------------------+
                      /        |        \
                     /         |         \
         +-----------+   +-----------+   +-----------+
         |  Cost      |   |  Budgets  |   |  Reports  |
         |  Analysis  |   |  & Alerts |   |  & Export |
         +-----------+   +-----------+   +-----------+
               |                |               |
        +------+--------+   +---+---+    +-------------+
        | Tagging/      |   | Azure |    | Power BI /  |
        | Resource Data |   | Policy|    | Excel Export|
        +---------------+   +-------+    +-------------+




Explanation:

Developers commit Terraform code to Git (Azure Repos or GitHub).

Azure DevOps Pipelines get triggered automatically on code push.

The pipeline executes Terraform commands (init, plan, apply).

Terraform uses an Azure Service Principal to authenticate with Azure.

The Azure Resource Manager (ARM) deploys and manages the resources as defined in the Terraform files.


Consistency: Deploy identical environments repeatedly.

Speed: Automate instead of manually configuring.

Scalability: Easily scale infrastructure.

Version Control: Track infrastructure changes in Git.

Integration: Works seamlessly with CI/CD pipelines like Azure DevOps.
